{
  "version": 3,
  "sources": ["../../@arcgis/core/views/interactive/snapping/featureSources/snappingCandidateElevationAlignment.js", "../../@arcgis/core/views/interactive/snapping/featureSources/snappingCandidateElevationFilter.js", "../../@arcgis/core/views/interactive/snapping/featureSources/symbologySnappingCandidates.js"],
  "sourcesContent": ["/*\r\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\r\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\r\n*/\r\nimport\"../../../../core/has.js\";import{LRUCache as e}from\"../../../../core/LRUCache.js\";import{getOrCreateMapValue as t}from\"../../../../core/MapUtils.js\";import{throwIfAborted as s}from\"../../../../core/promiseUtils.js\";import{getMetersPerVerticalUnitForSR as n}from\"../../../../core/unitUtils.js\";import{getMetersPerUnit as o}from\"../../../../symbols/support/unitConversionUtils.js\";function i(e=!1,t){if(e){const{elevationInfo:e,alignPointsInFeatures:s}=t;return new c(e,s)}return new a}class a{async alignCandidates(e,t,s){return e}notifyElevationSourceChange(){}}const r=1024;class c{constructor(t,s){this._elevationInfo=t,this._alignPointsInFeatures=s,this._alignmentsCache=new e(r),this._cacheVersion=0}async alignCandidates(e,t,s){const n=this._elevationInfo;return null==n||\"absolute-height\"!==n.mode||n.featureExpressionInfo?this._alignComputedElevationCandidates(e,t,s):(l(e,t,n),e)}notifyElevationSourceChange(){this._alignmentsCache.clear(),this._cacheVersion++}async _alignComputedElevationCandidates(e,n,o){const i=new Map;for(const s of e)t(i,s.objectId,d).push(s);const[a,r,c]=this._prepareQuery(i,n),h=await this._alignPointsInFeatures(a,o);s(o);if(c!==this._cacheVersion)return this._alignComputedElevationCandidates(e,n,o);this._applyCacheAndResponse(a,h,r);const{drapedObjectIds:u,failedObjectIds:l}=h,p=[];for(const t of e){const{objectId:e}=t;u.has(e)&&\"edge\"===t.type&&(t.draped=!0),l.has(e)||p.push(t)}return p}_prepareQuery(e,t){const s=[],n=[];for(const[o,i]of e){const e=[];for(const t of i)this._addToQueriesOrCachedResult(o,t.target,e,n),\"edge\"===t.type&&(this._addToQueriesOrCachedResult(o,t.start,e,n),this._addToQueriesOrCachedResult(o,t.end,e,n));0!==e.length&&s.push({objectId:o,points:e})}return[{spatialReference:t.toJSON(),pointsInFeatures:s},n,this._cacheVersion]}_addToQueriesOrCachedResult(e,t,s,n){const o=u(e,t),i=this._alignmentsCache.get(o);null==i?s.push(t):n.push(new h(t,i))}_applyCacheAndResponse(e,{elevations:t,drapedObjectIds:s,failedObjectIds:n},o){for(const r of o)r.apply();let i=0;const a=this._alignmentsCache;for(const{objectId:r,points:c}of e.pointsInFeatures){if(n.has(r)){i+=c.length;continue}const e=!s.has(r);for(const s of c){const n=u(r,s),o=t[i++];s.z=o,e&&a.put(n,o,1)}}}}class h{constructor(e,t){this.point=e,this.z=t}apply(){this.point.z=this.z}}function u(e,{x:t,y:s,z:n,spatialReference:o}){return`${e}-${t}-${s}-${n??0}}-wkid:${o?.wkid}`}function l(e,t,s){const{offset:i,unit:a}=s;if(null==i)return;const r=n(t),c=i*(o(a??\"meters\")/r);for(const n of e)switch(n.type){case\"edge\":n.start.z+=c,n.end.z+=c;continue;case\"vertex\":n.target.z+=c;continue}}function d(){return[]}export{i as getSnappingCandidateElevationAligner};\r\n", "/*\r\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\r\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\r\n*/\r\nimport\"../../../../core/has.js\";class t{filter(t,n){return n}notifyElevationSourceChange(){}}class n{filter(t,n){const{point:r,distance:c}=t,{z:i}=r;if(!(null!=i))return n;if(0===n.length)return n;const o=s(c),u=this._updateCandidatesTo3D(n,r,o).filter(e);return u.sort(a),u}_updateCandidatesTo3D(t,n,e){for(const r of t)switch(r.type){case\"edge\":c(r,n,e);continue;case\"vertex\":o(r,n,e);continue}return t}}function e(t){return t.distance<=1}function r(e=!1){return e?new n:new t}function c(t,n,{x:e,y:r,z:c}){const{start:o,end:s,target:a}=t;t.draped||i(a,n,o,s);const u=(n.x-a.x)/e,d=(n.y-a.y)/r,f=(n.z-a.z)/c;t.distance=Math.sqrt(u*u+d*d+f*f)}function i(t,n,e,r){const c=r.x-e.x,i=r.y-e.y,o=r.z-e.z,s=c*c+i*i+o*o,a=(n.x-e.x)*c+(n.y-e.y)*i+o*(n.z-e.z),u=Math.min(1,Math.max(0,a/s)),d=e.x+c*u,f=e.y+i*u,x=e.z+o*u;t.x=d,t.y=f,t.z=x}function o(t,n,{x:e,y:r,z:c}){const{target:i}=t,o=(n.x-i.x)/e,s=(n.y-i.y)/r,a=(n.z-i.z)/c,u=Math.sqrt(o*o+s*s+a*a);t.distance=u}function s(t){return\"number\"==typeof t?{x:t,y:t,z:t}:t}function a(t,n){return t.distance-n.distance}export{r as getSnappingCandidateElevationFilter};\r\n", "/*\r\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\r\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\r\n*/\r\nimport\"../../../../core/has.js\";import{clone as t}from\"../../../../core/lang.js\";import{LRUCache as e}from\"../../../../core/LRUCache.js\";import{throwIfAborted as s}from\"../../../../core/promiseUtils.js\";import{numericHash as o}from\"../../../../core/string.js\";function n(t=!1,e){return t?new i(e):new c}class c{async fetch(){return[]}notifySymbologyChange(){}}const r=1024;class i{constructor(t){this._getSymbologyCandidates=t,this._candidatesCache=new e(r),this._cacheVersion=0}async fetch(e,o){if(0===e.length)return[];const n=[],c=[],r=this._candidatesCache;for(const s of e){const e=a(s),o=r.get(e);if(o)for(const s of o)c.push(t(s));else n.push(s),r.put(e,[],1)}if(0===n.length)return c;const i=this._cacheVersion,{candidates:h,sourceCandidateIndices:d}=await this._getSymbologyCandidates(n,o);s(o);if(i!==this._cacheVersion)return this.fetch(e,o);const f=[],{length:g}=h;for(let s=0;s<g;++s){const e=h[s],o=a(n[d[s]]),c=r.get(o);c.push(e),r.put(o,c,c.length),f.push(t(e))}return c.concat(f)}notifySymbologyChange(){this._candidatesCache.clear(),this._cacheVersion++}}function a(t){switch(t.type){case\"vertex\":{const{objectId:e,target:s}=t,n=`${e}-vertex-${s.x}-${s.y}-${s.z??0}`;return o(n).toString()}case\"edge\":{const{objectId:e,start:s,end:n}=t,c=`${e}-edge-${s.x}-${s.y}-${s.z??0}-to-${n.x}-${n.y}-${n.z??0}`;return o(c).toString()}default:return\"\"}}export{n as getSymbologySnappingCandidatesFetcher};\r\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;AAIiY,SAAS,EAAEA,KAAE,OAAGC,IAAE;AAAC,MAAGD,IAAE;AAAC,UAAK,EAAC,eAAcA,IAAE,uBAAsBE,GAAC,IAAED;AAAE,WAAO,IAAI,EAAED,IAAEE,EAAC;AAAA,EAAC;AAAC,SAAO,IAAIC;AAAC;AAAC,IAAMA,KAAN,MAAO;AAAA,EAAC,MAAM,gBAAgBH,IAAEC,IAAEC,IAAE;AAAC,WAAOF;AAAA,EAAC;AAAA,EAAC,8BAA6B;AAAA,EAAC;AAAC;AAAC,IAAM,IAAE;AAAK,IAAM,IAAN,MAAO;AAAA,EAAC,YAAYC,IAAEC,IAAE;AAAC,SAAK,iBAAeD,IAAE,KAAK,yBAAuBC,IAAE,KAAK,mBAAiB,IAAI,EAAE,CAAC,GAAE,KAAK,gBAAc;AAAA,EAAC;AAAA,EAAC,MAAM,gBAAgBF,IAAEC,IAAEC,IAAE;AAAC,UAAME,KAAE,KAAK;AAAe,WAAO,QAAMA,MAAG,sBAAoBA,GAAE,QAAMA,GAAE,wBAAsB,KAAK,kCAAkCJ,IAAEC,IAAEC,EAAC,KAAGG,GAAEL,IAAEC,IAAEG,EAAC,GAAEJ;AAAA,EAAE;AAAA,EAAC,8BAA6B;AAAC,SAAK,iBAAiB,MAAM,GAAE,KAAK;AAAA,EAAe;AAAA,EAAC,MAAM,kCAAkCA,IAAEI,IAAEE,IAAE;AAAC,UAAMC,KAAE,oBAAI;AAAI,eAAUL,MAAKF,GAAE,GAAEO,IAAEL,GAAE,UAAS,CAAC,EAAE,KAAKA,EAAC;AAAE,UAAK,CAACC,IAAEK,IAAEC,EAAC,IAAE,KAAK,cAAcF,IAAEH,EAAC,GAAEM,KAAE,MAAM,KAAK,uBAAuBP,IAAEG,EAAC;AAAE,MAAEA,EAAC;AAAE,QAAGG,OAAI,KAAK,cAAc,QAAO,KAAK,kCAAkCT,IAAEI,IAAEE,EAAC;AAAE,SAAK,uBAAuBH,IAAEO,IAAEF,EAAC;AAAE,UAAK,EAAC,iBAAgBG,IAAE,iBAAgBN,GAAC,IAAEK,IAAE,IAAE,CAAC;AAAE,eAAUT,MAAKD,IAAE;AAAC,YAAK,EAAC,UAASA,GAAC,IAAEC;AAAE,MAAAU,GAAE,IAAIX,EAAC,KAAG,WAASC,GAAE,SAAOA,GAAE,SAAO,OAAII,GAAE,IAAIL,EAAC,KAAG,EAAE,KAAKC,EAAC;AAAA,IAAC;AAAC,WAAO;AAAA,EAAC;AAAA,EAAC,cAAcD,IAAEC,IAAE;AAAC,UAAMC,KAAE,CAAC,GAAEE,KAAE,CAAC;AAAE,eAAS,CAACE,IAAEC,EAAC,KAAIP,IAAE;AAAC,YAAMA,KAAE,CAAC;AAAE,iBAAUC,MAAKM,GAAE,MAAK,4BAA4BD,IAAEL,GAAE,QAAOD,IAAEI,EAAC,GAAE,WAASH,GAAE,SAAO,KAAK,4BAA4BK,IAAEL,GAAE,OAAMD,IAAEI,EAAC,GAAE,KAAK,4BAA4BE,IAAEL,GAAE,KAAID,IAAEI,EAAC;AAAG,YAAIJ,GAAE,UAAQE,GAAE,KAAK,EAAC,UAASI,IAAE,QAAON,GAAC,CAAC;AAAA,IAAC;AAAC,WAAM,CAAC,EAAC,kBAAiBC,GAAE,OAAO,GAAE,kBAAiBC,GAAC,GAAEE,IAAE,KAAK,aAAa;AAAA,EAAC;AAAA,EAAC,4BAA4BJ,IAAEC,IAAEC,IAAEE,IAAE;AAAC,UAAME,KAAEK,GAAEX,IAAEC,EAAC,GAAEM,KAAE,KAAK,iBAAiB,IAAID,EAAC;AAAE,YAAMC,KAAEL,GAAE,KAAKD,EAAC,IAAEG,GAAE,KAAK,IAAI,EAAEH,IAAEM,EAAC,CAAC;AAAA,EAAC;AAAA,EAAC,uBAAuBP,IAAE,EAAC,YAAWC,IAAE,iBAAgBC,IAAE,iBAAgBE,GAAC,GAAEE,IAAE;AAAC,eAAUE,MAAKF,GAAE,CAAAE,GAAE,MAAM;AAAE,QAAID,KAAE;AAAE,UAAMJ,KAAE,KAAK;AAAiB,eAAS,EAAC,UAASK,IAAE,QAAOC,GAAC,KAAIT,GAAE,kBAAiB;AAAC,UAAGI,GAAE,IAAII,EAAC,GAAE;AAAC,QAAAD,MAAGE,GAAE;AAAO;AAAA,MAAQ;AAAC,YAAMT,KAAE,CAACE,GAAE,IAAIM,EAAC;AAAE,iBAAUN,MAAKO,IAAE;AAAC,cAAML,KAAEO,GAAEH,IAAEN,EAAC,GAAEI,KAAEL,GAAEM,IAAG;AAAE,QAAAL,GAAE,IAAEI,IAAEN,MAAGG,GAAE,IAAIC,IAAEE,IAAE,CAAC;AAAA,MAAC;AAAA,IAAC;AAAA,EAAC;AAAC;AAAC,IAAM,IAAN,MAAO;AAAA,EAAC,YAAYN,IAAEC,IAAE;AAAC,SAAK,QAAMD,IAAE,KAAK,IAAEC;AAAA,EAAC;AAAA,EAAC,QAAO;AAAC,SAAK,MAAM,IAAE,KAAK;AAAA,EAAC;AAAC;AAAC,SAASU,GAAEX,IAAE,EAAC,GAAEC,IAAE,GAAEC,IAAE,GAAEE,IAAE,kBAAiBE,GAAC,GAAE;AAAC,SAAM,GAAGN,EAAC,IAAIC,EAAC,IAAIC,EAAC,IAAIE,MAAG,CAAC,UAAUE,IAAG,IAAI;AAAE;AAAC,SAASD,GAAEL,IAAEC,IAAEC,IAAE;AAAC,QAAK,EAAC,QAAOK,IAAE,MAAKJ,GAAC,IAAED;AAAE,MAAG,QAAMK,GAAE;AAAO,QAAMC,KAAE,EAAEP,EAAC,GAAEQ,KAAEF,MAAG,EAAEJ,MAAG,QAAQ,IAAEK;AAAG,aAAUJ,MAAKJ,GAAE,SAAOI,GAAE,MAAK;AAAA,IAAC,KAAI;AAAO,MAAAA,GAAE,MAAM,KAAGK,IAAEL,GAAE,IAAI,KAAGK;AAAE;AAAA,IAAS,KAAI;AAAS,MAAAL,GAAE,OAAO,KAAGK;AAAE;AAAA,EAAQ;AAAC;AAAC,SAAS,IAAG;AAAC,SAAM,CAAC;AAAC;;;ACAjjF,IAAM,IAAN,MAAO;AAAA,EAAC,OAAOG,IAAEC,IAAE;AAAC,WAAOA;AAAA,EAAC;AAAA,EAAC,8BAA6B;AAAA,EAAC;AAAC;AAAC,IAAMA,KAAN,MAAO;AAAA,EAAC,OAAOD,IAAEC,IAAE;AAAC,UAAK,EAAC,OAAMC,IAAE,UAASC,GAAC,IAAEH,IAAE,EAAC,GAAEI,GAAC,IAAEF;AAAE,QAAG,EAAE,QAAME,IAAG,QAAOH;AAAE,QAAG,MAAIA,GAAE,OAAO,QAAOA;AAAE,UAAMI,KAAEC,GAAEH,EAAC,GAAEI,KAAE,KAAK,sBAAsBN,IAAEC,IAAEG,EAAC,EAAE,OAAOG,EAAC;AAAE,WAAOD,GAAE,KAAKE,EAAC,GAAEF;AAAA,EAAC;AAAA,EAAC,sBAAsBP,IAAEC,IAAEO,IAAE;AAAC,eAAUN,MAAKF,GAAE,SAAOE,GAAE,MAAK;AAAA,MAAC,KAAI;AAAO,QAAAC,GAAED,IAAED,IAAEO,EAAC;AAAE;AAAA,MAAS,KAAI;AAAS,UAAEN,IAAED,IAAEO,EAAC;AAAE;AAAA,IAAQ;AAAC,WAAOR;AAAA,EAAC;AAAC;AAAC,SAASQ,GAAER,IAAE;AAAC,SAAOA,GAAE,YAAU;AAAC;AAAC,SAASE,GAAEM,KAAE,OAAG;AAAC,SAAOA,KAAE,IAAIP,OAAE,IAAI;AAAC;AAAC,SAASE,GAAEH,IAAEC,IAAE,EAAC,GAAEO,IAAE,GAAEN,IAAE,GAAEC,GAAC,GAAE;AAAC,QAAK,EAAC,OAAME,IAAE,KAAIC,IAAE,QAAOG,GAAC,IAAET;AAAE,EAAAA,GAAE,UAAQI,GAAEK,IAAER,IAAEI,IAAEC,EAAC;AAAE,QAAMC,MAAGN,GAAE,IAAEQ,GAAE,KAAGD,IAAEE,MAAGT,GAAE,IAAEQ,GAAE,KAAGP,IAAE,KAAGD,GAAE,IAAEQ,GAAE,KAAGN;AAAE,EAAAH,GAAE,WAAS,KAAK,KAAKO,KAAEA,KAAEG,KAAEA,KAAE,IAAE,CAAC;AAAC;AAAC,SAASN,GAAEJ,IAAEC,IAAEO,IAAEN,IAAE;AAAC,QAAMC,KAAED,GAAE,IAAEM,GAAE,GAAEJ,KAAEF,GAAE,IAAEM,GAAE,GAAEH,KAAEH,GAAE,IAAEM,GAAE,GAAEF,KAAEH,KAAEA,KAAEC,KAAEA,KAAEC,KAAEA,IAAEI,MAAGR,GAAE,IAAEO,GAAE,KAAGL,MAAGF,GAAE,IAAEO,GAAE,KAAGJ,KAAEC,MAAGJ,GAAE,IAAEO,GAAE,IAAGD,KAAE,KAAK,IAAI,GAAE,KAAK,IAAI,GAAEE,KAAEH,EAAC,CAAC,GAAEI,KAAEF,GAAE,IAAEL,KAAEI,IAAE,IAAEC,GAAE,IAAEJ,KAAEG,IAAE,IAAEC,GAAE,IAAEH,KAAEE;AAAE,EAAAP,GAAE,IAAEU,IAAEV,GAAE,IAAE,GAAEA,GAAE,IAAE;AAAC;AAAC,SAAS,EAAEA,IAAEC,IAAE,EAAC,GAAEO,IAAE,GAAEN,IAAE,GAAEC,GAAC,GAAE;AAAC,QAAK,EAAC,QAAOC,GAAC,IAAEJ,IAAEK,MAAGJ,GAAE,IAAEG,GAAE,KAAGI,IAAEF,MAAGL,GAAE,IAAEG,GAAE,KAAGF,IAAEO,MAAGR,GAAE,IAAEG,GAAE,KAAGD,IAAEI,KAAE,KAAK,KAAKF,KAAEA,KAAEC,KAAEA,KAAEG,KAAEA,EAAC;AAAE,EAAAT,GAAE,WAASO;AAAC;AAAC,SAASD,GAAEN,IAAE;AAAC,SAAM,YAAU,OAAOA,KAAE,EAAC,GAAEA,IAAE,GAAEA,IAAE,GAAEA,GAAC,IAAEA;AAAC;AAAC,SAASS,GAAET,IAAEC,IAAE;AAAC,SAAOD,GAAE,WAASC,GAAE;AAAQ;;;ACA7xB,SAASU,GAAEC,KAAE,OAAGC,IAAE;AAAC,SAAOD,KAAE,IAAIE,GAAED,EAAC,IAAE,IAAIE;AAAC;AAAC,IAAMA,KAAN,MAAO;AAAA,EAAC,MAAM,QAAO;AAAC,WAAM,CAAC;AAAA,EAAC;AAAA,EAAC,wBAAuB;AAAA,EAAC;AAAC;AAAC,IAAMC,KAAE;AAAK,IAAMF,KAAN,MAAO;AAAA,EAAC,YAAYF,IAAE;AAAC,SAAK,0BAAwBA,IAAE,KAAK,mBAAiB,IAAI,EAAEI,EAAC,GAAE,KAAK,gBAAc;AAAA,EAAC;AAAA,EAAC,MAAM,MAAMH,IAAEI,IAAE;AAAC,QAAG,MAAIJ,GAAE,OAAO,QAAM,CAAC;AAAE,UAAMF,KAAE,CAAC,GAAEI,KAAE,CAAC,GAAEC,KAAE,KAAK;AAAiB,eAAUE,MAAKL,IAAE;AAAC,YAAMA,KAAEM,GAAED,EAAC,GAAED,KAAED,GAAE,IAAIH,EAAC;AAAE,UAAGI,GAAE,YAAUC,MAAKD,GAAE,CAAAF,GAAE,KAAK,EAAEG,EAAC,CAAC;AAAA,UAAO,CAAAP,GAAE,KAAKO,EAAC,GAAEF,GAAE,IAAIH,IAAE,CAAC,GAAE,CAAC;AAAA,IAAC;AAAC,QAAG,MAAIF,GAAE,OAAO,QAAOI;AAAE,UAAMD,KAAE,KAAK,eAAc,EAAC,YAAWM,IAAE,wBAAuBC,GAAC,IAAE,MAAM,KAAK,wBAAwBV,IAAEM,EAAC;AAAE,MAAEA,EAAC;AAAE,QAAGH,OAAI,KAAK,cAAc,QAAO,KAAK,MAAMD,IAAEI,EAAC;AAAE,UAAM,IAAE,CAAC,GAAE,EAAC,QAAO,EAAC,IAAEG;AAAE,aAAQF,KAAE,GAAEA,KAAE,GAAE,EAAEA,IAAE;AAAC,YAAML,KAAEO,GAAEF,EAAC,GAAED,KAAEE,GAAER,GAAEU,GAAEH,EAAC,CAAC,CAAC,GAAEH,KAAEC,GAAE,IAAIC,EAAC;AAAE,MAAAF,GAAE,KAAKF,EAAC,GAAEG,GAAE,IAAIC,IAAEF,IAAEA,GAAE,MAAM,GAAE,EAAE,KAAK,EAAEF,EAAC,CAAC;AAAA,IAAC;AAAC,WAAOE,GAAE,OAAO,CAAC;AAAA,EAAC;AAAA,EAAC,wBAAuB;AAAC,SAAK,iBAAiB,MAAM,GAAE,KAAK;AAAA,EAAe;AAAC;AAAC,SAASI,GAAEP,IAAE;AAAC,UAAOA,GAAE,MAAK;AAAA,IAAC,KAAI,UAAS;AAAC,YAAK,EAAC,UAASC,IAAE,QAAOK,GAAC,IAAEN,IAAED,KAAE,GAAGE,EAAC,WAAWK,GAAE,CAAC,IAAIA,GAAE,CAAC,IAAIA,GAAE,KAAG,CAAC;AAAG,aAAO,EAAEP,EAAC,EAAE,SAAS;AAAA,IAAC;AAAA,IAAC,KAAI,QAAO;AAAC,YAAK,EAAC,UAASE,IAAE,OAAMK,IAAE,KAAIP,GAAC,IAAEC,IAAEG,KAAE,GAAGF,EAAC,SAASK,GAAE,CAAC,IAAIA,GAAE,CAAC,IAAIA,GAAE,KAAG,CAAC,OAAOP,GAAE,CAAC,IAAIA,GAAE,CAAC,IAAIA,GAAE,KAAG,CAAC;AAAG,aAAO,EAAEI,EAAC,EAAE,SAAS;AAAA,IAAC;AAAA,IAAC;AAAQ,aAAM;AAAA,EAAE;AAAC;",
  "names": ["e", "t", "s", "a", "n", "l", "o", "i", "r", "c", "h", "u", "t", "n", "r", "c", "i", "o", "s", "u", "e", "a", "d", "n", "t", "e", "i", "c", "r", "o", "s", "a", "h", "d"]
}
