{
  "version": 3,
  "sources": ["../../@arcgis/core/views/2d/engine/webgl/animatedFormats/utils.js"],
  "sourcesContent": ["/*\r\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\r\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\r\n*/\r\nimport{makeHandle as t}from\"../../../../../core/handleUtils.js\";import{Milliseconds as e}from\"../../../../../core/time.js\";import{AnimatedSymbolRepeatType as r}from\"../../../../../symbols/cim/enums.js\";import{getRandomValue as i}from\"../grouping.js\";function a(t){return e(t.frameDurations.reduce(((t,e)=>t+e),0))}function n(t){const{width:e,height:r}=t,i=t.frameDurations.reverse(),a=e=>{const r=t.frameDurations.length-1-e;return t.getFrame(r)};return{frameCount:t.frameCount,duration:t.duration,frameDurations:i,getFrame:a,width:e,height:r}}function o(t,r){const{width:i,height:a,getFrame:n}=t,o=r/t.duration,s=t.frameDurations.map((t=>e(t*o)));return{frameCount:t.frameCount,duration:t.duration,frameDurations:s,getFrame:n,width:i,height:a}}function s(t,r){const{width:i,height:a,getFrame:n}=t,o=t.frameDurations.slice(),s=o.shift();return o.unshift(e(s+r)),{frameCount:t.frameCount,duration:t.duration+r,frameDurations:o,getFrame:n,width:i,height:a}}function m(t,r){const{width:i,height:a,getFrame:n}=t,o=t.frameDurations.slice(),s=o.pop();return o.push(e(s+r)),{frameCount:t.frameCount,duration:t.duration+r,frameDurations:o,getFrame:n,width:i,height:a}}class u{constructor(t,e,r,i){this._animation=t,this._repeatType=r,this._onFrameData=i,this._direction=1,this._currentFrame=0,this.timeToFrame=this._animation.frameDurations[this._currentFrame];let a=0;for(;e>a;)a+=this.timeToFrame,this.nextFrame();const n=this._animation.getFrame(this._currentFrame);this._onFrameData(n)}nextFrame(){if(this._currentFrame+=this._direction,this._direction>0){if(this._currentFrame===this._animation.frameDurations.length)switch(this._repeatType){case r.None:this._currentFrame-=this._direction;break;case r.Loop:this._currentFrame=0;break;case r.Oscillate:this._currentFrame-=this._direction,this._direction=-1}}else if(-1===this._currentFrame)switch(this._repeatType){case r.None:this._currentFrame-=this._direction;break;case r.Loop:this._currentFrame=this._animation.frameDurations.length-1;break;case r.Oscillate:this._currentFrame-=this._direction,this._direction=1}this.timeToFrame=this._animation.frameDurations[this._currentFrame];const t=this._animation.getFrame(this._currentFrame);this._onFrameData(t)}}function h(t,h,c,f){let l,{repeatType:d}=h;if(null==d&&(d=r.Loop),!0===h.reverseAnimation&&(t=n(t)),null!=h.duration&&(t=o(t,e(1e3*h.duration))),null!=h.repeatDelay){const i=1e3*h.repeatDelay;d===r.Loop?t=m(t,e(i)):d===r.Oscillate&&(t=s(m(t,e(i/2)),e(i/2)))}if(null!=h.startTimeOffset)l=e(1e3*h.startTimeOffset);else if(null!=h.randomizeStartTime){const r=82749913,n=null!=h.randomizeStartSeed?h.randomizeStartSeed:r,o=i(c,n);l=e(o*a(t))}else l=e(0);return new u(t,l,d,f)}function c(e,r,i,a){const n=null==r.playAnimation||r.playAnimation,o=h(e,r,i,a);let s,m=o.timeToFrame;function u(){s=n?setTimeout((()=>{o.nextFrame(),m=o.timeToFrame,u()}),m):void 0}return u(),t((()=>n&&clearTimeout(s)))}export{u as Player,o as adjustDuration,m as appendDelay,h as createPlayer,a as getDuration,c as play,s as prependDelay,n as reverse};\r\n"],
  "mappings": "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",
  "names": ["t", "e", "n", "a", "r", "o", "s", "h", "c", "d", "m", "u"]
}
