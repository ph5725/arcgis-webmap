{
  "version": 3,
  "sources": ["../../@arcgis/core/chunks/OperatorShapePreservingLength.js"],
  "sourcesContent": ["/*\r\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\r\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\r\n*/\r\nimport{a as e,G as t,f as s,d as n}from\"./Geometry.js\";import{K as o,g as r,v as a,B as i,w as m}from\"./ProjectionTransformation.js\";import{a as c,P as g}from\"./MultiPathImpl.js\";import{n as u,d as p,P as h}from\"./Point2D.js\";import{d as y}from\"./Envelope.js\";import{Envelope2D as l}from\"./Envelope2D.js\";import{O as f}from\"./OperatorDensify.js\";import{O as _}from\"./OperatorClip.js\";function x(){return{m_pGcs:new h,m_xyz:new y,m_factor:Number.NaN,m_geoLength:Number.NaN,setValues:d,setLength:P,assign:S}}function d(e,t,s,n){this.m_factor=e,this.m_pGcs.assign(t),this.m_xyz.assign(n),this.m_geoLength=s}function P(e){this.m_geoLength=e}function S(e){this.m_pGcs.assign(e.m_pGcs),this.m_xyz.assign(e.m_xyz),this.m_factor=e.m_factor,this.m_geoLength=e.m_geoLength}class w{getOperatorType(){return 10315}supportsCurves(){return!0}accelerateGeometry(e,t,s){return!1}canAccelerateGeometry(e){return!1}_ExecuteShapePreservingLength(e,t,s,n,a){if(e.hasNonLinearSegments()){e=(new f).execute(e,0,t.getTolerance(0),0,a)}if(t.isPannable()){let n=90,r=-90;if(1===s.getUnit().getUnitToBaseFactor()&&(n*=Math.PI/180,r*=Math.PI/180),2===t.getCoordinateSystemType()){let e=null;const s=[0,0,0,0];e=t.getPECoordSys(),s[0]=0,s[1]=n,s[2]=0,s[3]=r,o.geogToProj(e,2,s),n=s[1],r=s[3]}const i=new l;e.queryEnvelope(i),i.ymin=r,i.ymax=n,e=(new _).execute(e,i,t,a)}else{const s=t.getPCSHorizon();if((e=(new r).execute(e,s,t,a))===s){const t=e.clone();e=t}}return e.isEmpty()?0:this._ExecuteIterativeApproach(e,t,s,n,1,a)}_ExecuteIterativeApproach(e,t,s,r,i,m){const c=a();s.querySpheroidData(c);const g=c.majorSemiAxis,l=c.e2,f=s.getUnit().getUnitToBaseFactor(),_=40,d=u(x,_),P=p(_,Number.NaN),S=x(),w=x();let E;const G=[0,0,0,0],j=t.getPECoordSys(),v=new h,L=new h,T=new h,D=new h,b=new h;let z=0;const I=e.querySegmentIterator();for(;I.nextPath();)for(;I.hasNextSegment();){const e=I.nextSegment();v.assign(e.getStartXY()),L.assign(e.getEndXY()),2===t.getCoordinateSystemType()?(G[0]=v.x,G[1]=v.y,G[2]=L.x,G[3]=L.y,o.projToGeog(j,2,G),T.x=G[0]*f,T.y=G[1]*f,D.x=G[2]*f,D.y=G[3]*f):(T.setCoordsPoint2D(v),D.setCoordsPoint2D(L),T.scale(f),D.scale(f));const s=new y,r=new y;N(g,l,T,s),N(g,l,D,r);let a=C(g,s,r);S.setValues(0,T,Number.NaN,s),w.setValues(1,D,a,r),E=i,d[0].assign(w),P[0]=i;let m=0;for(;;){m>128&&n(\"iterations exceeded\");const s=.5*(S.m_factor+w.m_factor),r=e.getCoord2D(s);2===t.getCoordinateSystemType()?(G[0]=r.x,G[1]=r.y,o.projToGeog(j,1,G),b.x=G[0]*f,b.y=G[1]*f):(b.setCoordsPoint2D(r),b.scale(f)),T.setCoordsPoint2D(S.m_pGcs),D.setCoordsPoint2D(w.m_pGcs);const c=new y;N(g,l,b,c);const u=C(g,S.m_xyz,c),p=C(g,w.m_xyz,c);a=w.m_geoLength,Number.isNaN(a)&&(a=C(g,S.m_xyz,w.m_xyz));const h=u+p,x=E===i&&h>=20&&Math.abs(h-a)>1e-8*(a+h);if(m+2<_&&(x||Math.abs(h-a)>0&&E>0))w.setLength(p),d[m].assign(w),w.setValues(s,b,u,c),d[++m].assign(w),x?(E=i,P[m]=i):(E--,P[m-1]=E,P[m]=E);else{if(z+=h,0===m)break;S.assign(w),w.assign(d[--m]),E=P[m]}}}return z}execute(n,o,r){if(o&&0!==o.getCoordinateSystemType()||e(\"\"),n.isEmpty()||n.getDimension()<1)return 0;let a=null;const m=o.getGCS();m!==o&&(a=i(o,m,null));const u=n.getGeometryType();if(u===t.enumEnvelope){const e=new c;return e.addEnvelope(n,!1),this._ExecuteShapePreservingLength(e,o,m,a,r)}if(s(u)){const e=new g;return e.addSegment(n,!0),this._ExecuteShapePreservingLength(e,o,m,a,r)}return this._ExecuteShapePreservingLength(n,o,m,a,r)}}function N(e,t,s,n){n.assign(m(e,t,s))}function C(e,t,s){const n=e,o=new y;o.setSub(t,s);const r=o.length();return 2*n*Math.asin(r/(2*n))}export{w as O};\r\n"],
  "mappings": "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",
  "names": ["P", "n", "a", "e", "s", "t", "m", "f", "d", "S", "w", "b", "I", "r", "c", "x"]
}
