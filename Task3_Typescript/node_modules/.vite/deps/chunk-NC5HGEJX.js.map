{
  "version": 3,
  "sources": ["../../@esri/calcite-components/dist/chunks/label.js"],
  "sourcesContent": ["/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.\r\nSee https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.\r\nv3.2.1 */\r\nimport { q as queryElementRoots, l as closestElementCrossShadowBoundary, m as isBefore } from \"./dom.js\";\r\nconst labelClickEvent = \"calciteInternalLabelClick\";\r\nconst labelConnectedEvent = \"calciteInternalLabelConnected\";\r\nconst labelDisconnectedEvent = \"calciteInternalLabelDisconnected\";\r\nconst labelTagName = \"calcite-label\";\r\nconst labelToLabelables = /* @__PURE__ */ new WeakMap();\r\nconst onLabelClickMap = /* @__PURE__ */ new WeakMap();\r\nconst onLabelConnectedMap = /* @__PURE__ */ new WeakMap();\r\nconst onLabelDisconnectedMap = /* @__PURE__ */ new WeakMap();\r\nconst unlabeledComponents = /* @__PURE__ */ new Set();\r\nconst findLabelForComponent = (componentEl) => {\r\n  const { id } = componentEl;\r\n  const forLabel = id && queryElementRoots(componentEl, { selector: `${labelTagName}[for=\"${id}\"]` });\r\n  if (forLabel) {\r\n    return forLabel;\r\n  }\r\n  const parentLabel = closestElementCrossShadowBoundary(componentEl, labelTagName);\r\n  if (!parentLabel || // labelable components within other custom elements are not considered labelable\r\n  hasAncestorCustomElements(parentLabel, componentEl)) {\r\n    return null;\r\n  }\r\n  return parentLabel;\r\n};\r\nfunction hasAncestorCustomElements(label, componentEl) {\r\n  let traversedElements;\r\n  const customElementAncestorCheckEventType = \"custom-element-ancestor-check\";\r\n  const listener = (event) => {\r\n    event.stopImmediatePropagation();\r\n    const composedPath = event.composedPath();\r\n    traversedElements = composedPath.slice(composedPath.indexOf(componentEl), composedPath.indexOf(label));\r\n  };\r\n  label.addEventListener(customElementAncestorCheckEventType, listener, { once: true });\r\n  componentEl.dispatchEvent(new CustomEvent(customElementAncestorCheckEventType, { composed: true, bubbles: true }));\r\n  label.removeEventListener(customElementAncestorCheckEventType, listener);\r\n  const ancestorCustomElements = traversedElements.filter((el) => el !== componentEl && el !== label).filter((el) => el.tagName?.includes(\"-\"));\r\n  return ancestorCustomElements.length > 0;\r\n}\r\nfunction connectLabel(component) {\r\n  if (!component) {\r\n    return;\r\n  }\r\n  const labelEl = findLabelForComponent(component.el);\r\n  if (onLabelClickMap.has(labelEl) && labelEl === component.labelEl || !labelEl && unlabeledComponents.has(component)) {\r\n    return;\r\n  }\r\n  const boundOnLabelDisconnected = onLabelDisconnected.bind(component);\r\n  if (labelEl) {\r\n    component.labelEl = labelEl;\r\n    const labelables = labelToLabelables.get(labelEl) || [];\r\n    labelables.push(component);\r\n    labelToLabelables.set(labelEl, labelables.sort(sortByDOMOrder));\r\n    if (!onLabelClickMap.has(component.labelEl)) {\r\n      onLabelClickMap.set(component.labelEl, onLabelClick);\r\n      component.labelEl.addEventListener(labelClickEvent, onLabelClick);\r\n    }\r\n    unlabeledComponents.delete(component);\r\n    document.removeEventListener(labelConnectedEvent, onLabelConnectedMap.get(component));\r\n    onLabelDisconnectedMap.set(component, boundOnLabelDisconnected);\r\n    document.addEventListener(labelDisconnectedEvent, boundOnLabelDisconnected);\r\n  } else if (!unlabeledComponents.has(component)) {\r\n    boundOnLabelDisconnected();\r\n    document.removeEventListener(labelDisconnectedEvent, onLabelDisconnectedMap.get(component));\r\n  }\r\n}\r\nfunction disconnectLabel(component) {\r\n  if (!component) {\r\n    return;\r\n  }\r\n  unlabeledComponents.delete(component);\r\n  document.removeEventListener(labelConnectedEvent, onLabelConnectedMap.get(component));\r\n  document.removeEventListener(labelDisconnectedEvent, onLabelDisconnectedMap.get(component));\r\n  onLabelConnectedMap.delete(component);\r\n  onLabelDisconnectedMap.delete(component);\r\n  if (!component.labelEl) {\r\n    return;\r\n  }\r\n  const labelables = labelToLabelables.get(component.labelEl);\r\n  if (labelables.length === 1) {\r\n    component.labelEl.removeEventListener(labelClickEvent, onLabelClickMap.get(component.labelEl));\r\n    onLabelClickMap.delete(component.labelEl);\r\n  }\r\n  labelToLabelables.set(\r\n    component.labelEl,\r\n    labelables.filter((labelable) => labelable !== component).sort(sortByDOMOrder)\r\n  );\r\n  component.labelEl = null;\r\n}\r\nfunction sortByDOMOrder(a, b) {\r\n  return isBefore(a.el, b.el) ? -1 : 1;\r\n}\r\nfunction getLabelText(component) {\r\n  return component.label || component.labelEl?.textContent?.trim() || \"\";\r\n}\r\nfunction onLabelClick(event) {\r\n  const labelClickTarget = event.detail.sourceEvent.target;\r\n  const labelables = labelToLabelables.get(this);\r\n  const clickedLabelable = labelables.find((labelable) => labelable.el === labelClickTarget);\r\n  const labelableChildClicked = labelables.includes(clickedLabelable);\r\n  if (labelableChildClicked) {\r\n    return;\r\n  }\r\n  const firstLabelable = labelables[0];\r\n  if (firstLabelable.disabled) {\r\n    return;\r\n  }\r\n  firstLabelable.onLabelClick(event);\r\n}\r\nfunction onLabelConnected() {\r\n  if (unlabeledComponents.has(this)) {\r\n    connectLabel(this);\r\n  }\r\n}\r\nfunction onLabelDisconnected() {\r\n  unlabeledComponents.add(this);\r\n  const boundOnLabelConnected = onLabelConnectedMap.get(this) || onLabelConnected.bind(this);\r\n  onLabelConnectedMap.set(this, boundOnLabelConnected);\r\n  document.addEventListener(labelConnectedEvent, boundOnLabelConnected);\r\n}\r\nasync function associateExplicitLabelToUnlabeledComponent(label) {\r\n  await label.componentOnReady();\r\n  const alreadyLabeled = labelToLabelables.has(label);\r\n  if (alreadyLabeled) {\r\n    return;\r\n  }\r\n  const forComponentEl = label.ownerDocument?.getElementById(label.for);\r\n  if (!forComponentEl) {\r\n    return;\r\n  }\r\n  requestAnimationFrame(() => {\r\n    for (const labelable of unlabeledComponents) {\r\n      if (labelable.el === forComponentEl) {\r\n        connectLabel(labelable);\r\n        break;\r\n      }\r\n    }\r\n  });\r\n}\r\nexport {\r\n  associateExplicitLabelToUnlabeledComponent as a,\r\n  labelDisconnectedEvent as b,\r\n  connectLabel as c,\r\n  disconnectLabel as d,\r\n  getLabelText as g,\r\n  labelConnectedEvent as l\r\n};\r\n"],
  "mappings": "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",
  "names": []
}
