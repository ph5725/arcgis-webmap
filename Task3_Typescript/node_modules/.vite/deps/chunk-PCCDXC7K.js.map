{
  "version": 3,
  "sources": ["../../@arcgis/core/portal/support/portalLayers.js"],
  "sourcesContent": ["/*\r\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\r\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\r\n*/\r\nimport e from\"../../core/Error.js\";import{findAssociatedFeatureService as a}from\"../../layers/support/associatedFeatureServiceUtils.js\";import{getLayerModuleType as r}from\"../../layers/support/fetchService.js\";import{LayerLoadContext as t}from\"../../layers/support/LayerLoadContext.js\";import{sceneServiceLayerTypeToClassName as s,applyPreferredHostToPortalItem as c,getPreferredHost as n}from\"../../layers/support/layerUtils.js\";import{layerLookupMap as o}from\"../../layers/support/lazyLayerLoader.js\";import i from\"../PortalItem.js\";import{getFirstLayerOrTable as u,getNumLayersAndTables as l,preprocessFSItemData as y,getLayerOrTable as m,layerTypeToLayerModuleType as f,populateSceneServiceItemData as p}from\"./loadUtils.js\";import{hasTypeKeyword as d}from\"./portalItemUtils.js\";async function L(e){let{portalItem:a}=e;!a||a instanceof i||(a=new i(a));const r=await w(a);return new(0,r.constructor)({portalItem:a,...r.properties})}async function w(e){await e.load();const a=new t;return S(await N(e,a))}async function N(a,r){switch(a.type){case\"3DTiles Service\":return a.typeKeywords.includes(\"3DObject\")?b():P();case\"CSV\":return F();case\"Feature Collection\":return M(a);case\"Feature Service\":return h(a,r);case\"Feed\":return x();case\"GeoJson\":return G();case\"Group Layer\":return J();case\"Image Service\":return g(a,r);case\"KML\":return V();case\"Knowledge Graph Layer\":return K();case\"Map Service\":return v(a,r);case\"Media Layer\":return k();case\"Scene Service\":return I(a,r);case\"Stream Service\":return j();case\"Video Service\":return T(a,r);case\"Vector Tile Service\":return C();case\"WCS\":return W();case\"WFS\":return U();case\"WMS\":return D();case\"WMTS\":return O();default:throw new e(\"portal:unknown-item-type\",\"Unknown item type '${type}'\",{type:a.type})}}async function S(e){const a=e.className,r=o[a];return{constructor:await r(),properties:e.properties}}async function v(e,a){return await $(e,a)?{className:\"TileLayer\"}:{className:\"MapImageLayer\"}}async function h(e,a){const r=await A(e,a);if(\"object\"==typeof r){const{sourceJSON:e,className:a}=r,t={sourceJSON:e};return null!=r.id&&(t.layerId=r.id),{className:a||\"FeatureLayer\",properties:t}}return{className:\"GroupLayer\"}}async function I(e,r){const t=await A(e,r,(async()=>{try{if(!e.url)return[];const{serverUrl:t}=await a(e.url,{sceneLayerItem:e}),s=await r.fetchServiceMetadata(t);return s?.tables??[]}catch{return[]}}));if(\"object\"==typeof t){const a={};let c;if(null!=t.id?(a.layerId=t.id,c=`${e.url}/layers/${t.id}`):c=e.url,e.typeKeywords?.length)for(const r of Object.keys(s))if(e.typeKeywords.includes(r))return{className:s[r]};const n=await r.fetchServiceMetadata(c,{customParameters:await r.fetchCustomParameters(e,(e=>u(e)?.customParameters))});return{className:s[n?.layerType]||\"SceneLayer\",properties:a}}if(!1===t){const a=await r.fetchServiceMetadata(e.url);if(\"Voxel\"===a?.layerType)return{className:\"VoxelLayer\"}}return{className:\"GroupLayer\"}}async function M(e){await e.load();const a=d(e,\"Map Notes\"),r=d(e,\"Markup\");if(a||r)return{className:\"MapNotesLayer\"};if(d(e,\"Route Layer\"))return{className:\"RouteLayer\"};const t=await e.fetchData();return 1===l(t)?{className:\"FeatureLayer\"}:{className:\"GroupLayer\"}}async function g(e,a){await e.load();const r=e.typeKeywords?.map((e=>e.toLowerCase()))??[];if(r.includes(\"elevation 3d layer\"))return{className:\"ElevationLayer\"};if(r.includes(\"tiled imagery\"))return{className:\"ImageryTileLayer\"};const t=await a.fetchItemData(e),s=t?.layerType;if(\"ArcGISTiledImageServiceLayer\"===s)return{className:\"ImageryTileLayer\"};if(\"ArcGISImageServiceLayer\"===s)return{className:\"ImageryLayer\"};const c=await a.fetchServiceMetadata(e.url,{customParameters:await a.fetchCustomParameters(e)}),n=c.cacheType?.toLowerCase(),o=c.capabilities?.toLowerCase().includes(\"tilesonly\"),i=c.tileInfo?.format?.toLowerCase()??\"\",u=null==n&&[\"jpg\",\"jpeg\",\"png\",\"png8\",\"png24\",\"png32\",\"mixed\"].includes(i);return\"map\"===n||u||o?{className:\"ImageryTileLayer\"}:{className:\"ImageryLayer\"}}function j(){return{className:\"StreamLayer\"}}async function T(e,a){return\"object\"==typeof await A(e,a)?{className:\"VideoLayer\"}:{className:\"GroupLayer\"}}function C(){return{className:\"VectorTileLayer\"}}function G(){return{className:\"GeoJSONLayer\"}}function P(){return{className:\"IntegratedMesh3DTilesLayer\"}}function b(){return{className:\"UnsupportedLayer\"}}function F(){return{className:\"CSVLayer\"}}function V(){return{className:\"KMLLayer\"}}function K(){return{className:\"KnowledgeGraphLayer\"}}function W(){return{className:\"WCSLayer\"}}function U(){return{className:\"WFSLayer\"}}function D(){return{className:\"WMSLayer\"}}function O(){return{className:\"WMTSLayer\"}}function x(){return{className:\"StreamLayer\"}}function J(){return{className:\"GroupLayer\"}}function k(){return{className:\"MediaLayer\"}}async function $(e,a){const{tileInfo:r}=await a.fetchServiceMetadata(e.url,{customParameters:await a.fetchCustomParameters(e)});return r}async function A(e,a,t){const{url:s,type:o}=e,i=\"Feature Service\"===o;if(!s)return{};if(/\\/\\d+$/.test(s)){if(i){const t=await a.fetchServiceMetadata(s,{customParameters:await a.fetchCustomParameters(e,(e=>u(e)?.customParameters))});return c(e,n()),{id:t.id,className:r(t.type),sourceJSON:t}}return{}}if(\"Video Service\"===o){const e=await a.fetchServiceMetadata(s);return!((e.layers?.length??0)>1)&&{}}await e.load();let d=await a.fetchItemData(e);if(i){const{data:r,preferredHost:t}=await y(d,s,a);c(e,t);const n=E(r);if(\"object\"==typeof n){const e=m(r,n.id);n.className=f(e?.layerType)}return n}\"Scene Service\"===o&&(d=await p(e,d,a));if(l(d)>0)return E(d);const L=await a.fetchServiceMetadata(s);return t&&(L.tables=await t()),E(L)}function E(e){return 1===l(e)&&{id:u(e)?.id}}export{L as fromItem,N as selectLayerClassPath};\r\n"],
  "mappings": "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",
  "names": ["e", "a", "h", "k", "A", "t", "s", "c", "r", "n", "i", "l", "L"]
}
