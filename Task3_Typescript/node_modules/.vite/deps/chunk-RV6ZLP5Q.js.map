{
  "version": 3,
  "sources": ["../../@arcgis/core/symbols/support/previewCIMSymbol.js"],
  "sourcesContent": ["/*\r\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\r\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\r\n*/\r\nimport{pt2px as e,px2pt as t}from\"../../core/screenUtils.js\";import{CIMSymbolHelper as i}from\"../cim/CIMSymbolHelper.js\";import{CIMSymbolRasterizer as o}from\"../cim/CIMSymbolRasterizer.js\";import{OverrideHelper as l}from\"../cim/OverrideHelper.js\";import{mapCIMSymbolToGeometryType as r}from\"../cim/utils.js\";import{SymbolSizeDefaults as n}from\"./previewUtils.js\";import{renderSymbol as a}from\"./renderUtils.js\";const s=new o(null),m=t(n.size),h=t(n.maxSize),c=t(n.lineWidth),y=1;async function u(e,t,i){const o=t?.size;let l=null!=o&&\"object\"==typeof o&&\"width\"in o?o.width:o,r=null!=o&&\"object\"==typeof o&&\"height\"in o?o.height:o;if(!l||!r)if(\"esriGeometryPolygon\"===i)l=r=t.maxSize?Math.min(t.maxSize,m):m;else{const o=await g(e,t,i);o&&(l=o.width,r=o.height),\"esriGeometryPolyline\"===i&&(l=t.maxSize?Math.min(t.maxSize,c):c),l=null!=l&&isFinite(l)?Math.min(l,h):m,r=null!=r&&isFinite(r)?Math.max(Math.min(r,h),y):m}return\"legend\"===t.style&&\"esriGeometryPolyline\"===i&&(l=c),{width:l,height:r}}async function g(e,t={},o){const n=t.cimOptions||t;o??=n.geometryType||r(e?.data?.symbol);const{feature:a,fieldMap:m,viewParams:h}=n,c=await l.resolveSymbolOverrides(e.data,a,null,m,o,null,h);if(!c)return null;(e=e.clone()).data={type:\"CIMSymbolReference\",symbol:c},e.data.primitiveOverrides=void 0;const y=[];return i.fetchResources(c,s.resourceManager,y),i.fetchFonts(c,s.resourceManager,y),y.length>0&&await Promise.all(y),i.getEnvelope(c,null,s.resourceManager)}async function d(i,o={}){const{node:l,opacity:n,symbolConfig:m}=o,h=null!=m&&\"object\"==typeof m&&\"isSquareFill\"in m&&m.isSquareFill,c=o.cimOptions||o,y=c.geometryType||r(i?.data?.symbol),g=await u(i,o,y),{feature:d,fieldMap:f}=c,p=o?.geometry||h||\"esriGeometryPolygon\"!==y?\"preview\":\"legend\";let w=g;const b=g;if(o?.geometry&&(\"esriGeometryPolygon\"===y||\"esriGeometryPolyline\"===y)){const i=200;if(e(g.width)<i||e(g.height)<i){const e=g.width>g.height?t(i)*g.height/g.width:t(i);w={width:g.width>g.height?t(i):t(i)*g.width/g.height,height:e}}}const M=await s.rasterizeCIMSymbolAsync(i,d,w,p,f,y,null,c.viewParams,c.allowScalingUp,o?.geometry?.toJSON());if(!M)return null;const{width:S,height:v}=M,j=document.createElement(\"canvas\");j.width=S,j.height=v;j.getContext(\"2d\").putImageData(M,0,0);const x=e(b.width),z=e(b.height),P=new Image(x,z);P.src=j.toDataURL(),P.ariaLabel=o.ariaLabel??null,P.alt=o.ariaLabel??\"\",null!=n&&(P.style.opacity=`${n}`);let C=P;if(null!=o.effectView){const e={shape:{type:\"image\",x:0,y:0,width:x,height:z,src:P.src},fill:null,stroke:null,offset:[0,0]};C=a([[e]],[x,z],o)}return l&&C&&l.appendChild(C),C}export{g as getCIMSymbolPreviewSize,d as previewCIMSymbol};\r\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;AAI2Z,IAAM,IAAE,IAAI,EAAE,IAAI;AAAlB,IAAoB,IAAE,EAAE,EAAE,IAAI;AAA9B,IAAgC,IAAE,EAAE,EAAE,OAAO;AAA7C,IAA+C,IAAE,EAAE,EAAE,SAAS;AAA9D,IAAgE,IAAE;AAAE,eAAeA,GAAEC,IAAEC,IAAE,GAAE;AAAC,QAAM,IAAEA,IAAG;AAAK,MAAIC,KAAE,QAAM,KAAG,YAAU,OAAO,KAAG,WAAU,IAAE,EAAE,QAAM,GAAE,IAAE,QAAM,KAAG,YAAU,OAAO,KAAG,YAAW,IAAE,EAAE,SAAO;AAAE,MAAG,CAACA,MAAG,CAAC,EAAE,KAAG,0BAAwB,EAAE,CAAAA,KAAE,IAAED,GAAE,UAAQ,KAAK,IAAIA,GAAE,SAAQ,CAAC,IAAE;AAAA,OAAM;AAAC,UAAME,KAAE,MAAMC,GAAEJ,IAAEC,IAAE,CAAC;AAAE,IAAAE,OAAID,KAAEC,GAAE,OAAM,IAAEA,GAAE,SAAQ,2BAAyB,MAAID,KAAED,GAAE,UAAQ,KAAK,IAAIA,GAAE,SAAQ,CAAC,IAAE,IAAGC,KAAE,QAAMA,MAAG,SAASA,EAAC,IAAE,KAAK,IAAIA,IAAE,CAAC,IAAE,GAAE,IAAE,QAAM,KAAG,SAAS,CAAC,IAAE,KAAK,IAAI,KAAK,IAAI,GAAE,CAAC,GAAE,CAAC,IAAE;AAAA,EAAC;AAAC,SAAM,aAAWD,GAAE,SAAO,2BAAyB,MAAIC,KAAE,IAAG,EAAC,OAAMA,IAAE,QAAO,EAAC;AAAC;AAAC,eAAeE,GAAEJ,IAAEC,KAAE,CAAC,GAAE,GAAE;AAAC,QAAM,IAAEA,GAAE,cAAYA;AAAE,QAAI,EAAE,gBAAc,EAAED,IAAG,MAAM,MAAM;AAAE,QAAK,EAAC,SAAQ,GAAE,UAASK,IAAE,YAAWC,GAAC,IAAE,GAAEC,KAAE,MAAM,EAAE,uBAAuBP,GAAE,MAAK,GAAE,MAAKK,IAAE,GAAE,MAAKC,EAAC;AAAE,MAAG,CAACC,GAAE,QAAO;AAAK,GAACP,KAAEA,GAAE,MAAM,GAAG,OAAK,EAAC,MAAK,sBAAqB,QAAOO,GAAC,GAAEP,GAAE,KAAK,qBAAmB;AAAO,QAAMQ,KAAE,CAAC;AAAE,SAAO,GAAE,eAAeD,IAAE,EAAE,iBAAgBC,EAAC,GAAE,GAAE,WAAWD,IAAE,EAAE,iBAAgBC,EAAC,GAAEA,GAAE,SAAO,KAAG,MAAM,QAAQ,IAAIA,EAAC,GAAE,GAAE,YAAYD,IAAE,MAAK,EAAE,eAAe;AAAC;AAAC,eAAe,EAAE,GAAE,IAAE,CAAC,GAAE;AAAC,QAAK,EAAC,MAAKL,IAAE,SAAQ,GAAE,cAAaG,GAAC,IAAE,GAAEC,KAAE,QAAMD,MAAG,YAAU,OAAOA,MAAG,kBAAiBA,MAAGA,GAAE,cAAaE,KAAE,EAAE,cAAY,GAAEC,KAAED,GAAE,gBAAc,EAAE,GAAG,MAAM,MAAM,GAAEH,KAAE,MAAML,GAAE,GAAE,GAAES,EAAC,GAAE,EAAC,SAAQC,IAAE,UAAS,EAAC,IAAEF,IAAE,IAAE,GAAG,YAAUD,MAAG,0BAAwBE,KAAE,YAAU;AAAS,MAAI,IAAEJ;AAAE,QAAM,IAAEA;AAAE,MAAG,GAAG,aAAW,0BAAwBI,MAAG,2BAAyBA,KAAG;AAAC,UAAME,KAAE;AAAI,QAAG,EAAEN,GAAE,KAAK,IAAEM,MAAG,EAAEN,GAAE,MAAM,IAAEM,IAAE;AAAC,YAAMV,KAAEI,GAAE,QAAMA,GAAE,SAAO,EAAEM,EAAC,IAAEN,GAAE,SAAOA,GAAE,QAAM,EAAEM,EAAC;AAAE,UAAE,EAAC,OAAMN,GAAE,QAAMA,GAAE,SAAO,EAAEM,EAAC,IAAE,EAAEA,EAAC,IAAEN,GAAE,QAAMA,GAAE,QAAO,QAAOJ,GAAC;AAAA,IAAC;AAAA,EAAC;AAAC,QAAM,IAAE,MAAM,EAAE,wBAAwB,GAAES,IAAE,GAAE,GAAE,GAAED,IAAE,MAAKD,GAAE,YAAWA,GAAE,gBAAe,GAAG,UAAU,OAAO,CAAC;AAAE,MAAG,CAAC,EAAE,QAAO;AAAK,QAAK,EAAC,OAAM,GAAE,QAAOI,GAAC,IAAE,GAAE,IAAE,SAAS,cAAc,QAAQ;AAAE,IAAE,QAAM,GAAE,EAAE,SAAOA;AAAE,IAAE,WAAW,IAAI,EAAE,aAAa,GAAE,GAAE,CAAC;AAAE,QAAM,IAAE,EAAE,EAAE,KAAK,GAAEC,KAAE,EAAE,EAAE,MAAM,GAAE,IAAE,IAAI,MAAM,GAAEA,EAAC;AAAE,IAAE,MAAI,EAAE,UAAU,GAAE,EAAE,YAAU,EAAE,aAAW,MAAK,EAAE,MAAI,EAAE,aAAW,IAAG,QAAM,MAAI,EAAE,MAAM,UAAQ,GAAG,CAAC;AAAI,MAAI,IAAE;AAAE,MAAG,QAAM,EAAE,YAAW;AAAC,UAAMZ,KAAE,EAAC,OAAM,EAAC,MAAK,SAAQ,GAAE,GAAE,GAAE,GAAE,OAAM,GAAE,QAAOY,IAAE,KAAI,EAAE,IAAG,GAAE,MAAK,MAAK,QAAO,MAAK,QAAO,CAAC,GAAE,CAAC,EAAC;AAAE,QAAE,EAAE,CAAC,CAACZ,EAAC,CAAC,GAAE,CAAC,GAAEY,EAAC,GAAE,CAAC;AAAA,EAAC;AAAC,SAAOV,MAAG,KAAGA,GAAE,YAAY,CAAC,GAAE;AAAC;",
  "names": ["u", "e", "t", "l", "o", "g", "m", "h", "c", "y", "d", "i", "v", "z"]
}
